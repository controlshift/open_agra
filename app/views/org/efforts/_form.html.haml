= simple_form_for [:org, @effort], validate: true, :wrapper => 'compact' do |form|
  = form.input :title,  input_html: { class:  'span9'}
  = form.input :description,  input_html: { class:  'span9'}
  = form.input :gutter_text,  input_html: { class:  'span9'}
  = form.input :image, as: :file
  = form.input :thanks_for_creating_email, label: "Thanks for creating petition email",  input_html: { class:  'span9'}

  - if Content.for_slug_and_organisation('welcome_email', current_organisation)
    %a.btn#apply-default-btn Apply Default Email Body
    :javascript
      $('#effort_thanks_for_creating_email').tinymce({
        mode : 'textareas',
        theme: 'advanced',
        theme_advanced_toolbar_location : "top",
        theme_advanced_buttons1 : "bold,italic,underline,|,fontselect,fontsizeselect,forecolor,backcolor,link,numlist,bullist,justifyleft,justifycenter,justifyright,|,code",
        theme_advanced_buttons2 : "",
        theme_advanced_buttons3 : "",
        theme_advanced_toolbar_align : "left",
        width : 690,
        relative_urls : false,
        remove_script_host : false,
        document_base_url : getDirPath(document.URL),
        content_css : "/tinymce_content.css"
      });

      function getDirPath(URL) {
          var result = unescape(URL.substring(0,(URL.lastIndexOf("/")) + 1))
          return result
      }

      $("#apply-default-btn").click(function() {
         var template = $("#default_thanks_email").html();
         $("#effort_thanks_for_creating_email").val(template);
       });
    .hidden#default_thanks_email
      = Content.for_slug_and_organisation('welcome_email', current_organisation).body.html_safe


  %br
  %br
  %br
  %p
    The following fields override elements of standard petition forms.

  %ul
    %li
      %b
        Label
      is the name of the field
    %li
      %b
        Help
      is the popover help text
    %li
      %b
        Default
      is the default value

  %p
    If these fields are left blank, the standard label & help text and no default petition text will be used.
  %br

  - [:title, :who, :what, :why].each do |petition_field|
    = form.input "#{petition_field}_label",   input_html: { class:  'span9'}
    = form.input "#{petition_field}_help",    input_html: { class:  'span9'}
    = form.input "#{petition_field}_default", input_html: { class:  'span9'}


  = form.input :ask_for_location
  .actions
    = form.button :submit
